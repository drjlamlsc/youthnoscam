<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Youth No Scam – Screening Sliders (Mobile, EN / 中文)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --bg-card: #020617;
      --border: #1f2937;
      --accent: #22d3ee;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
      padding: 12px;
    }

    .app {
      max-width: 640px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      margin-bottom: 8px;
    }

    h1 {
      font-size: 1.3rem;
      margin: 0 0 4px;
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .lang-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      font-size: 0.8rem;
      color: var(--muted);
      padding: 4px 8px;
      border-radius: 999px;
      background: #020617;
      border: 1px solid var(--border);
    }

    .lang-toggle button {
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      font-size: 0.8rem;
      padding: 3px 10px;
      cursor: pointer;
    }

    .lang-toggle button.active {
      border-color: var(--accent);
      color: var(--accent);
      background: #020617;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 8px;
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    .step-indicator {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .card {
      background: linear-gradient(145deg, #020617, #020617);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 14px 14px 10px;
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.55);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
    }

    .badge {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--accent);
      color: var(--accent);
      white-space: nowrap;
    }

    .card-desc {
      font-size: 0.78rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .question {
      margin-bottom: 18px;
      padding-bottom: 6px;
      border-bottom: 1px dashed var(--border);
    }

    .question:last-of-type {
      border-bottom: none;
      padding-bottom: 0;
    }

    .question-label {
      font-size: 0.78rem;
      margin-bottom: 6px;
      line-height: 1.4;
    }

    .question-label span.code {
      color: var(--muted);
      font-size: 0.7rem;
      margin-right: 4px;
    }

    .options-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 4px;
    }

    .option-dot {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--muted);
      font-size: 0.78rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
    }

    .option-dot.selected {
      border-color: var(--accent);
      color: var(--accent);
      background: #0b1120;
    }

    .scale-legend {
      display: flex;
      justify-content: space-between;
      font-size: 0.68rem;
      color: var(--muted);
      margin: 2px 0 0;
    }

    .score-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-top: 8px;
      padding-top: 6px;
      border-top: 1px dashed var(--border);
      font-size: 0.78rem;
    }

    .score-main {
      font-weight: 600;
      font-size: 0.82rem;
    }

    .score-main span {
      color: var(--accent);
    }

    .score-sub {
      font-size: 0.74rem;
      color: var(--muted);
      text-align: right;
    }

    .risk-chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.72rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
    }

    .risk-chip.low span.dot,
    .risk-chip.mod span.dot,
    .risk-chip.high span.dot,
    .risk-chip.vhigh span.dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }

    .risk-chip.low span.dot { background: #22c55e; }
    .risk-chip.mod span.dot { background: #eab308; }
    .risk-chip.high span.dot { background: #f97316; }
    .risk-chip.vhigh span.dot { background: var(--danger); }

    .results-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .result-row {
      padding: 6px 8px;
      border-radius: 10px;
      background: #020617;
      border: 1px solid #1f2937;
      font-size: 0.8rem;
    }

    .result-top {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
    }

    .result-label {
      color: var(--muted);
    }

    .result-score {
      color: var(--accent);
      font-weight: 600;
    }

    .result-note {
      margin-top: 4px;
      font-size: 0.72rem;
      color: var(--muted);
    }

    .disclaimer {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 12px;
      line-height: 1.5;
    }

    .disclaimer strong {
      color: #f97373;
      font-weight: 600;
    }

    .tagline {
      font-size: 0.72rem;
      margin-top: 6px;
      color: var(--muted);
    }

    .nav-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding-top: 8px;
      border-top: 1px solid #0b1120;
      position: sticky;
      bottom: 0;
      background: rgba(2, 6, 23, 0.96);
      backdrop-filter: blur(6px);
      margin-top: 4px;
    }

    .nav-btn {
      flex: 1;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text);
      font-size: 0.9rem;
      padding: 8px 0;
      cursor: pointer;
    }

    .nav-btn.primary {
      border-color: var(--accent);
      background: #0369a1;
    }

    .nav-btn:disabled {
      opacity: 0.4;
      cursor: default;
    }

    .nav-middle {
      min-width: 80px;
      text-align: center;
      font-size: 0.75rem;
      color: var(--muted);
    }

    @media (min-width: 700px) {
      h1 { font-size: 1.4rem; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Youth No Scam – Screening Sliders</h1>
      <p class="subtitle">
        One screen per questionnaire. Tap the circles to choose your answer.
        Scores update automatically. Questions can be shown in English or 中文（繁體）。
      </p>

      <div class="lang-toggle">
        <span>Language / 語言：</span>
        <button type="button" data-lang="en">EN</button>
        <button type="button" data-lang="zh" class="active">中文</button>
      </div>
      <div class="step-indicator" id="step-indicator"></div>
    </header>

    <div class="content">
      <section class="page" data-page="0" id="page-phq9"></section>
      <section class="page" data-page="1" id="page-gad7"></section>
      <section class="page" data-page="2" id="page-bscs"></section>
      <section class="page" data-page="3" id="page-ucla3"></section>
      <section class="page" data-page="4" id="page-scam"></section>

      <!-- Results page -->
      <section class="page" data-page="5" id="page-results">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Overall results</div>
          </div>
          <div class="card-desc">
            Review the total scores across all questionnaires. Higher scores usually
            mean more of that area (e.g. symptoms, loneliness, susceptibility).
          </div>
          <div id="results-summary" class="results-list"></div>
          <p class="disclaimer">
            <strong>Important:</strong> This tool is for education and rough screening only.
            It does not diagnose any condition and must not replace a full clinical assessment.
            If scores are high or you are worried, please discuss with a qualified
            health professional or counsellor.
          </p>
          <p class="tagline">
            Designed for multidisciplinary use in youth scam protection and mental health awareness.
          </p>
        </div>
      </section>
    </div>

    <div class="nav-bar">
      <button class="nav-btn" id="prev-btn">上一頁</button>
      <div class="nav-middle" id="nav-middle-text"></div>
      <button class="nav-btn primary" id="next-btn">下一頁</button>
    </div>
  </div>

  <script>
    // Default language: Chinese (written, zh-tw style)
    let currentLang = 'zh';
    let currentPage = 0;

    const stepNames = [
      'PHQ-9 – mood',
      'GAD-7 – anxiety',
      'Self-control (BSCS)',
      'Loneliness (UCLA-3)',
      'Scam risk (5 items)',
      'Results'
    ];

    // ---------- Items (EN + zh written) ----------
    const phq9Items = [
      {
        code: "PHQ-1",
        labelEn: "Loss of interest or enjoyment in everyday activities.",
        labelZh: "對平日喜歡做的事情失去興趣或樂趣。"
      },
      {
        code: "PHQ-2",
        labelEn: "Feeling sad, low, or without hope.",
        labelZh: "覺得心情低落、憂鬱，或覺得沒有希望。"
      },
      {
        code: "PHQ-3",
        labelEn: "Difficulty getting to sleep, staying asleep, or sleeping far more than usual.",
        labelZh: "入睡困難、睡眠容易中斷，或睡得比平常多很多。"
      },
      {
        code: "PHQ-4",
        labelEn: "Feeling tired or having very little energy.",
        labelZh: "經常感到疲倦或缺乏精力。"
      },
      {
        code: "PHQ-5",
        labelEn: "Changes in appetite, such as eating too little or too much.",
        labelZh: "食慾明顯改變，例如吃得太少或太多。"
      },
      {
        code: "PHQ-6",
        labelEn: "Harsh self-criticism or feeling like a failure to yourself or others.",
        labelZh: "經常責怪自己，覺得自己失敗或辜負了別人。"
      },
      {
        code: "PHQ-7",
        labelEn: "Difficulty concentrating on tasks like reading, studying, or watching something.",
        labelZh: "很難專心做事，例如看書、工作或看節目。"
      },
      {
        code: "PHQ-8",
        labelEn: "Moving or speaking much more slowly than usual, or feeling very restless and fidgety.",
        labelZh: "說話或動作比平常明顯變慢，或相反地感到坐立難安、一直想動。"
      },
      {
        code: "PHQ-9",
        labelEn: "Recurring thoughts of death or of harming yourself.",
        labelZh: "不時出現與死亡相關的想法，或傷害自己的念頭。"
      }
    ];

    const gad7Items = [
      {
        code: "GAD-1",
        labelEn: "Feeling nervous, tense, or on edge.",
        labelZh: "感到緊張、焦慮或難以放鬆。"
      },
      {
        code: "GAD-2",
        labelEn: "Finding it hard to stop or control worrying.",
        labelZh: "很難停止或控制擔心的想法。"
      },
      {
        code: "GAD-3",
        labelEn: "Worrying a lot about many different things.",
        labelZh: "對許多不同的事情反覆擔心。"
      },
      {
        code: "GAD-4",
        labelEn: "Difficulty relaxing or unwinding.",
        labelZh: "感到難以放鬆或鬆弛下來。"
      },
      {
        code: "GAD-5",
        labelEn: "Feeling so restless that it is hard to sit still.",
        labelZh: "感到坐立不安，好像很難安靜坐著。"
      },
      {
        code: "GAD-6",
        labelEn: "Getting easily annoyed or irritable.",
        labelZh: "容易生氣或變得煩躁。"
      },
      {
        code: "GAD-7",
        labelEn: "Feeling afraid as if something bad might happen.",
        labelZh: "經常擔心會發生不好的事情。"
      }
    ];

    const bscsItems = [
      {
        code: "BSCS-1",
        labelEn: "I am generally good at resisting temptations that are not good for me.",
        labelZh: "一般來說，我擅長抵抗對自己不好的誘惑。"
      },
      {
        code: "BSCS-2",
        labelEn: "I find it hard to break habits that I know are unhelpful.",
        labelZh: "即使知道某些習慣不好，我仍然很難改掉。"
      },
      {
        code: "BSCS-3",
        labelEn: "I often put off work or responsibilities when I should start.",
        labelZh: "我常常把應該開始做的工作或責任往後拖。"
      },
      {
        code: "BSCS-4",
        labelEn: "I sometimes say or do things without thinking through the impact.",
        labelZh: "我有時會在沒有充分考慮後果前就說話或行動。"
      },
      {
        code: "BSCS-5",
        labelEn: "I can refuse things that are clearly bad for my health or future.",
        labelZh: "面對明顯不利於健康或前途的事情時，我有能力拒絕。"
      },
      {
        code: "BSCS-6",
        labelEn: "If something is enjoyable, I may still do it even when I know it is not wise.",
        labelZh: "即使知道不太明智，遇到令人愉快的事情時，我有時仍會照做。"
      },
      {
        code: "BSCS-7",
        labelEn: "I wish I had stronger self-discipline in daily life.",
        labelZh: "我希望自己在日常生活中能更有自律。"
      },
      {
        code: "BSCS-8",
        labelEn: "People who know me well would describe me as having strong self-control.",
        labelZh: "熟悉我的人會形容我相當有自制力。"
      },
      {
        code: "BSCS-9",
        labelEn: "Enjoyment and fun sometimes interfere with finishing important tasks.",
        labelZh: "享樂或玩樂有時會影響我完成重要的工作或功課。"
      },
      {
        code: "BSCS-10",
        labelEn: "I sometimes have trouble keeping my attention on what I am doing.",
        labelZh: "我有時很難長時間專注在手邊的事情。"
      },
      {
        code: "BSCS-11",
        labelEn: "I am able to work steadily toward long-term goals.",
        labelZh: "我能穩定地朝長期目標持續努力。"
      },
      {
        code: "BSCS-12",
        labelEn: "At times I cannot stop myself from doing something, even when I know it is wrong.",
        labelZh: "有時即使知道不對，我仍然無法阻止自己去做。"
      },
      {
        code: "BSCS-13",
        labelEn: "I often act quickly without considering all the options.",
        labelZh: "我常常很快就採取行動，而沒有充分考慮所有選擇。"
      }
    ];

    const ucla3Items = [
      {
        code: "UCLA-1",
        labelEn: "How often do you feel that you lack company or close companionship?",
        labelZh: "你多久會覺得缺少陪伴或親近的伙伴？"
      },
      {
        code: "UCLA-2",
        labelEn: "How often do you feel left out by others?",
        labelZh: "你多久會覺得被別人冷落或排除在外？"
      },
      {
        code: "UCLA-3",
        labelEn: "How often do you feel isolated from the people around you?",
        labelZh: "你多久會覺得與身邊的人疏離，好像被孤立？"
      }
    ];

    const scamItems = [
      {
        code: "SCAM-1",
        labelEn: "I tend to answer phone calls or messages even when I do not recognise the number or sender.",
        labelZh: "即使不認識來電號碼或帳號，我通常仍會接聽電話或回覆訊息。"
      },
      {
        code: "SCAM-2",
        labelEn: "I sometimes keep listening to sales or promotional offers even when I am not interested.",
        labelZh: "即使不太感興趣，我有時仍會繼續聽別人推銷或介紹優惠。"
      },
      {
        code: "SCAM-3",
        labelEn: "When an offer sounds very attractive, I may believe it before checking carefully.",
        labelZh: "遇到聽起來非常吸引的優惠時，我有時在未詳細查證前就傾向相信。"
      },
      {
        code: "SCAM-4",
        labelEn: "Other people have, at times, taken advantage of my trust or kindness.",
        labelZh: "有人曾經利用我較容易信任他人或心地善良的特質。"
      },
      {
        code: "SCAM-5",
        labelEn: "I feel confident that I can usually spot and avoid scams.",
        labelZh: "我有信心自己通常能辨識並避免各類詐騙。（正式計分時可能需要反向計分。）"
      }
    ];

    const scales = [
      {
        id: "phq9",
        name: "PHQ-9",
        badge: "Depression",
        description: "9 items scored 0–3 (past 2 weeks).",
        items: phq9Items,
        min: 0,
        max: 3,
        legendLeft: "0 = not at all / 完全沒有",
        legendRight: "3 = nearly every day / 幾乎每天",
        maxTotal: 27,
        interpret: (score) => {
          if (score <= 4) return { label: "Minimal", class: "low" };
          if (score <= 9) return { label: "Mild", class: "mod" };
          if (score <= 14) return { label: "Moderate", class: "high" };
          if (score <= 19) return { label: "Moderately severe", class: "vhigh" };
          return { label: "Severe", class: "vhigh" };
        }
      },
      {
        id: "gad7",
        name: "GAD-7",
        badge: "Anxiety",
        description: "7 items scored 0–3 (past 2 weeks).",
        items: gad7Items,
        min: 0,
        max: 3,
        legendLeft: "0 = not at all / 完全沒有",
        legendRight: "3 = nearly every day / 幾乎每天",
        maxTotal: 21,
        interpret: (score) => {
          if (score <= 4) return { label: "Minimal", class: "low" };
          if (score <= 9) return { label: "Mild", class: "mod" };
          if (score <= 14) return { label: "Moderate", class: "high" };
          return { label: "Severe", class: "vhigh" };
        }
      },
      {
        id: "bscs",
        name: "Brief Self-Control Scale",
        badge: "Self-control",
        description: "13 items scored 1–5 (higher = more self-control).",
        items: bscsItems,
        min: 1,
        max: 5,
        legendLeft: "1 = strongly disagree / 非常不同意",
        legendRight: "5 = strongly agree / 非常同意",
        maxTotal: 65,
        interpret: (score) => {
          const min = 13;
          const max = 65;
          const pct = (score - min) / (max - min);
          if (pct < 0.25) return { label: "Low self-control", class: "vhigh" };
          if (pct < 0.5) return { label: "Below average", class: "high" };
          if (pct < 0.75) return { label: "Average", class: "mod" };
          return { label: "High self-control", class: "low" };
        }
      },
      {
        id: "ucla3",
        name: "UCLA 3-Item Loneliness",
        badge: "Loneliness",
        description: "3 items scored 1–3 (higher = more loneliness).",
        items: ucla3Items,
        min: 1,
        max: 3,
        legendLeft: "1 = hardly ever / 幾乎不會",
        legendRight: "3 = often / 經常",
        maxTotal: 9,
        interpret: (score) => {
          if (score <= 3) return { label: "Low loneliness", class: "low" };
          if (score <= 5) return { label: "Moderate", class: "mod" };
          return { label: "High loneliness", class: "high" };
        }
      },
      {
        id: "scam",
        name: "Susceptibility to Scams (5-item)",
        badge: "Scam risk",
        description: "5 items scored 1–7 (higher = more vulnerability).",
        items: scamItems,
        min: 1,
        max: 7,
        legendLeft: "1 = strongly disagree / 非常不同意",
        legendRight: "7 = strongly agree / 非常同意",
        maxTotal: 35,
        interpret: (score) => {
          const min = 5;
          const max = 35;
          const pct = (score - min) / (max - min);
          if (pct < 0.25) return { label: "Low scam risk", class: "low" };
          if (pct < 0.5) return { label: "Moderate", class: "mod" };
          if (pct < 0.75) return { label: "High", class: "high" };
          return { label: "Very high", class: "vhigh" };
        }
      }
    ];

    const state = {};

    function buildScaleCard(scale, containerId) {
      const container = document.getElementById(containerId);
      if (!container) return;

      const card = document.createElement("div");
      card.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";

      const title = document.createElement("div");
      title.className = "card-title";
      title.textContent = scale.name;

      const badge = document.createElement("div");
      badge.className = "badge";
      badge.textContent = scale.badge;

      header.appendChild(title);
      header.appendChild(badge);

      const desc = document.createElement("div");
      desc.className = "card-desc";
      desc.textContent = scale.description;

      card.appendChild(header);
      card.appendChild(desc);

      scale.items.forEach((item) => {
        const q = document.createElement("div");
        q.className = "question";

        const label = document.createElement("div");
        label.className = "question-label";
        label.dataset.qid = `${scale.id}-${item.code}`;
        const text = currentLang === 'zh' ? item.labelZh : item.labelEn;
        label.innerHTML =
          `<span class="code">${item.code}</span>` +
          `<span class="qtext">${text}</span>`;
        q.appendChild(label);

        const optionsRow = document.createElement("div");
        optionsRow.className = "options-row";

        const defaultValue = scale.min; // lowest score as default
        for (let val = scale.min; val <= scale.max; val++) {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "option-dot";
          btn.textContent = val;
          btn.dataset.code = item.code;
          btn.dataset.value = String(val);

          if (val === defaultValue) {
            btn.classList.add("selected");
            state[item.code] = val;
          }

          btn.addEventListener("click", () => {
            // Unselect others for this item
            document.querySelectorAll(`.option-dot[data-code="${item.code}"]`)
              .forEach(b => b.classList.remove("selected"));
            btn.classList.add("selected");
            state[item.code] = val;
            updateScores();
          });

          optionsRow.appendChild(btn);
        }

        q.appendChild(optionsRow);

        const legend = document.createElement("div");
        legend.className = "scale-legend";
        legend.innerHTML =
          `<span>${scale.legendLeft}</span><span>${scale.legendRight}</span>`;

        q.appendChild(legend);
        card.appendChild(q);
      });

      // Ensure defaults are set for any items not covered (fallback)
      scale.items.forEach(item => {
        if (typeof state[item.code] === 'undefined') {
          const def = scale.min;
          state[item.code] = def;
        }
      });

      const scoreRow = document.createElement("div");
      scoreRow.className = "score-row";
      scoreRow.id = `score-${scale.id}`;

      const scoreMain = document.createElement("div");
      scoreMain.className = "score-main";
      scoreMain.innerHTML = `Total: <span>0</span> / ${scale.maxTotal}`;

      const scoreSub = document.createElement("div");
      scoreSub.className = "score-sub";
      scoreSub.textContent = "Interpretation will appear here.";

      scoreRow.appendChild(scoreMain);
      scoreRow.appendChild(scoreSub);
      card.appendChild(scoreRow);

      container.appendChild(card);
    }

    function renderScales() {
      buildScaleCard(scales[0], "page-phq9");
      buildScaleCard(scales[1], "page-gad7");
      buildScaleCard(scales[2], "page-bscs");
      buildScaleCard(scales[3], "page-ucla3");
      buildScaleCard(scales[4], "page-scam");
    }

    function updateScores() {
      const results = [];
      scales.forEach(scale => {
        let total = 0;
        scale.items.forEach(item => {
          total += state[item.code] || 0;
        });
        const interp = scale.interpret(total);
        const scoreRow = document.getElementById(`score-${scale.id}`);
        if (scoreRow) {
          const mainSpan = scoreRow.querySelector(".score-main span");
          const sub = scoreRow.querySelector(".score-sub");
          mainSpan.textContent = total;
          sub.innerHTML =
            `<span class="risk-chip ${interp.class}">` +
            `<span class="dot"></span>${interp.label}</span>`;
        }
        results.push({
          id: scale.id,
          name: scale.name,
          total,
          max: scale.maxTotal,
          interp
        });
      });

      const resultsDiv = document.getElementById("results-summary");
      if (resultsDiv) {
        resultsDiv.innerHTML = "";
        results.forEach(r => {
          const row = document.createElement("div");
          row.className = "result-row";

          const top = document.createElement("div");
          top.className = "result-top";

          const label = document.createElement("div");
          label.className = "result-label";
          label.textContent = r.name;

          const score = document.createElement("div");
          score.className = "result-score";
          score.textContent = `${r.total} / ${r.max}`;

          top.appendChild(label);
          top.appendChild(score);

          const note = document.createElement("div");
          note.className = "result-note";
          note.innerHTML =
            `<span class="risk-chip ${r.interp.class}">` +
            `<span class="dot"></span>${r.interp.label}</span>`;

          row.appendChild(top);
          row.appendChild(note);
          resultsDiv.appendChild(row);
        });
      }
    }

    function updateLanguageUI() {
      // Toggle button styles
      document.querySelectorAll(".lang-toggle button").forEach(btn => {
        btn.classList.toggle("active", btn.dataset.lang === currentLang);
      });

      // Update question texts
      scales.forEach(scale => {
        scale.items.forEach(item => {
          const qid = `${scale.id}-${item.code}`;
          const label = document.querySelector(
            `.question-label[data-qid="${qid}"]`
          );
          if (!label) return;
          const spanText = label.querySelector(".qtext");
          if (!spanText) return;
          spanText.textContent =
            currentLang === 'zh' ? item.labelZh : item.labelEn;
        });
      });

      // Update nav button labels based on language + page
      updateNavLabels();
    }

    function updateNavLabels() {
      const prevBtn = document.getElementById("prev-btn");
      const nextBtn = document.getElementById("next-btn");
      const middleText = document.getElementById("nav-middle-text");

      const prevLabel = currentLang === 'zh' ? '上一頁' : 'Previous';
      const nextLabel = currentLang === 'zh' ? '下一頁' : 'Next';
      const finishLabel = currentLang === 'zh' ? '完成' : 'Finish';

      prevBtn.textContent = prevLabel;

      if (currentPage < 4) {
        nextBtn.textContent = nextLabel;
        nextBtn.disabled = false;
        middleText.textContent = '';
      } else if (currentPage === 4) {
        nextBtn.textContent = finishLabel;
        nextBtn.disabled = false;
        middleText.textContent = '';
      } else {
        nextBtn.textContent = nextLabel;
        nextBtn.disabled = true;
        middleText.textContent = currentLang === 'zh' ? '結果' : 'Results';
      }

      prevBtn.disabled = currentPage === 0;
    }

    function showPage(index) {
      const pages = document.querySelectorAll(".page");
      pages.forEach((p, i) => {
        p.classList.toggle("active", i === index);
      });
      currentPage = index;

      const stepText = document.getElementById("step-indicator");
      stepText.textContent = `Step ${index + 1} of 6 – ${stepNames[index]}`;

      updateNavLabels();
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderScales();
      updateScores();
      updateLanguageUI();
      showPage(0);

      // Language toggle
      document.querySelectorAll(".lang-toggle button").forEach(btn => {
        btn.addEventListener("click", () => {
          const lang = btn.dataset.lang;
          if (lang && lang !== currentLang) {
            currentLang = lang;
            updateLanguageUI();
          }
        });
      });

      // Navigation buttons
      const prevBtn = document.getElementById("prev-btn");
      const nextBtn = document.getElementById("next-btn");

      prevBtn.addEventListener("click", () => {
        if (currentPage > 0) {
          showPage(currentPage - 1);
        }
      });

      nextBtn.addEventListener("click", () => {
        if (currentPage < 5) {
          showPage(currentPage + 1);
        }
      });
    });
  </script>
</body>
</html>
